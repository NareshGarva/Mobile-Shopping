<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product Management</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .color-preview {
      width: 30px;
      height: 30px;
      display: inline-block;
      margin-right: 5px;
      border-radius: 50%;
    }
    .product-image {
      width: 100px;
      height: 100px;
      object-fit: cover;
      margin-right: 5px;
    }
  </style>
</head>
<body>

<!-- Modal -->
<div class="modal fade" id="productModal" tabindex="-1" aria-labelledby="productModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="productModalLabel">Add/Edit Product</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="productForm">
          <div class="mb-3">
            <label for="productTitle" class="form-label">Product Title</label>
            <input type="text" class="form-control" id="productTitle" required>
          </div>
          <div class="mb-3">
            <label for="productDescription" class="form-label">Product Description</label>
            <textarea class="form-control" id="productDescription" rows="3" required></textarea>
          </div>
          <div class="mb-3">
            <label for="productCategory" class="form-label">Category</label>
            <input type="text" class="form-control" id="productCategory" required>
          </div>
          <div class="mb-3">
            <label for="originalPrice" class="form-label">Original Price</label>
            <input type="number" class="form-control" id="originalPrice" required>
          </div>
          <div class="mb-3">
            <label for="sellingPrice" class="form-label">Selling Price</label>
            <input type="number" class="form-control" id="sellingPrice" required>
          </div>
          <div class="mb-3">
            <label for="productStock" class="form-label">Stock</label>
            <input type="number" class="form-control" id="productStock" required>
          </div>
          <div class="mb-3">
            <label for="productWarranty" class="form-label">Warranty</label>
            <input type="text" class="form-control" id="productWarranty" required>
          </div>
          <div class="mb-3">
            <label for="mainImageInput" class="form-label">Main Image</label>
            <input type="file" class="form-control" id="mainImageInput" accept="image/*">
          </div>
          <div class="mb-3">
            <label for="casualImagesInput" class="form-label">Casual Images</label>
            <input type="file" class="form-control" id="casualImagesInput" accept="image/*" multiple>
          </div>
          <div class="mb-3">
            <label for="colorInput" class="form-label">Colors</label>
            <input type="text" class="form-control" id="colorInput" placeholder="Enter colors separated by comma">
          </div>
          <div class="mb-3" id="sizesContainer"></div>
          <button type="button" class="btn btn-secondary" id="addSizeBtn">Add Size</button>
          <div class="mb-3" id="specificationsContainer"></div>
          <button type="button" class="btn btn-secondary" id="addSpecificationBtn">Add Specification</button>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="submit" class="btn btn-primary" id="saveProductBtn">Save Product</button>
      </div>
    </div>
  </div>
</div>

<!-- View Product Modal -->
<div class="modal fade" id="viewProductModal" tabindex="-1" aria-labelledby="viewProductModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="viewProductModalLabel">View Product</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body" id="viewDetails"></div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" id="viewEditBtn">Edit Product</button>
      </div>
    </div>
  </div>
</div>

<div class="container mt-5">
  <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#productModal">Add Product</button>
  <table class="table table-striped mt-3" id="productTable">
    <thead>
      <tr>
        <th>Product ID</th>
        <th>Title</th>
        <th>Category</th>
        <th>Price</th>
        <th>Stock</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // Initialize Modal
  const productModal = new bootstrap.Modal(document.getElementById('productModal'));
  const viewModal = new bootstrap.Modal(document.getElementById('viewProductModal'));
  
  // Sample Data (You can replace this with an API call)
  let products = [];

  // Add Size Input Functionality
  document.getElementById('addSizeBtn').addEventListener('click', function() {
    const sizeRow = document.createElement("div");
    sizeRow.classList.add("row", "mb-2", "align-items-center");
    sizeRow.innerHTML = `
      <div class="col-5">
        <input type="text" class="form-control" placeholder="Size Name" required>
      </div>
      <div class="col-5">
        <input type="text" class="form-control" placeholder="Size Value" required>
      </div>
      <div class="col-2">
        <button type="button" class="btn btn-sm remove-row" style="background:rgba(255, 133, 133, 0.54); border: none;">
          <img src="./assets/icons/delete.svg"> 
        </button>
      </div>
    `;
    document.getElementById('sizesContainer').appendChild(sizeRow);
    sizeRow.querySelector('.remove-row').addEventListener('click', function() {
      sizeRow.remove();
    });
  });

  // Add Specification Input Functionality
  document.getElementById('addSpecificationBtn').addEventListener('click', function() {
    const specRow = document.createElement("div");
    specRow.classList.add("row", "mb-2", "align-items-center");
    specRow.innerHTML = `
      <div class="col-5">
        <input type="text" class="form-control" placeholder="Specification Name" required>
      </div>
      <div class="col-5">
        <input type="text" class="form-control" placeholder="Specification Value" required>
      </div>
      <div class="col-2">
        <button type="button" class="btn btn-sm remove-row" style="background:rgba(255, 133, 133, 0.54); border: none;">
          <img src="./assets/icons/delete.svg"> 
        </button>
      </div>
    `;
    document.getElementById('specificationsContainer').appendChild(specRow);
    specRow.querySelector('.remove-row').addEventListener('click', function() {
      specRow.remove();
    });
  });

  // Save product (form submission)
  document.getElementById('productForm').addEventListener('submit', async function(event) {
    event.preventDefault();
    const formData = new FormData(this);
    
    const product = {
      id: Date.now(),
      title: formData.get('productTitle'),
      description: formData.get('productDescription'),
      category: formData.get('productCategory'),
      originalPrice: formData.get('originalPrice'),
      sellingPrice: formData.get('sellingPrice'),
      stock: formData.get('productStock'),
      warranty: formData.get('productWarranty'),
      colors: formData.get('colorInput').split(',').map(c => c.trim()),
      sizes: getSizesFromForm(),
      specifications: getSpecificationsFromForm(),
      mainImage: document.getElementById('mainImageInput').files[0] || null,
      casualImages: Array.from(document.getElementById('casualImagesInput').files) || []
    };
    
    products.push(product);
    alert('Product saved successfully');
    renderProducts();
    productModal.hide();
    resetForm();
  });

  // Render Products List
  function renderProducts() {
    const tableBody = document.getElementById('productTable').getElementsByTagName('tbody')[0];
    tableBody.innerHTML = '';
    products.forEach(product => {
      const row = tableBody.insertRow();
      row.innerHTML = `
        <td>${product.id}</td>
        <td>${product.title}</td>
        <td>${product.category}</td>
        <td>₹${product.sellingPrice}</td>
        <td>${product.stock}</td>
        <td>
          <button class="btn btn-info btn-sm" onclick="viewProduct(${product.id})">View</button>
        </td>
      `;
    });
  }

  // View Product Function
  function viewProduct(id) {
    const product = products.find(p => p.id === id);
    if (!product) return;

    let colorsHtml = product.colors.map(color => `<span class="color-preview" style="background: ${color};"></span>`).join('');
    let sizesHtml = Object.entries(product.sizes).map(([key, value]) => `<div><strong>${key}:</strong> ${value}</div>`).join('');
    let specsHtml = Object.entries(product.specifications).map(([key, value]) => `<tr><td>${key}</td><td>${value}</td></tr>`).join('');

    document.getElementById('viewDetails').innerHTML = `
      <h4>${product.title}</h4>
      <p><strong>Category:</strong> ${product.category}</p>
      <p><strong>Description:</strong> ${product.description}</p>
      <p><strong>Price:</strong> ₹${product.sellingPrice}</p>
      <p><strong>Stock:</strong> ${product.stock}</p>
      <p><strong>Colors:</strong> ${colorsHtml}</p>
      <h5>Sizes:</h5>
      <div>${sizesHtml}</div>
      <h5>Specifications:</h5>
      <table class="table">
        <thead>
          <tr><th>Name</th><th>Value</th></tr>
        </thead>
        <tbody>
          ${specsHtml}
        </tbody>
      </table>
    `;
    viewModal.show();
  }

  // Get Sizes from form
  function getSizesFromForm() {
    const sizeInputs = document.querySelectorAll('#sizesContainer .row');
    let sizes = {};
    sizeInputs.forEach(row => {
      const sizeName = row.querySelector('input:nth-child(1)').value;
      const sizeValue = row.querySelector('input:nth-child(2)').value;
      if (sizeName && sizeValue) {
        sizes[sizeName] = sizeValue;
      }
    });
    return sizes;
  }

  // Get Specifications from form
  function getSpecificationsFromForm() {
    const specInputs = document.querySelectorAll('#specificationsContainer .row');
    let specifications = {};
    specInputs.forEach(row => {
      const specName = row.querySelector('input:nth-child(1)').value;
      const specValue = row.querySelector('input:nth-child(2)').value;
      if (specName && specValue) {
        specifications[specName] = specValue;
      }
    });
    return specifications;
  }

  // Reset the form
  function resetForm() {
    document.getElementById('productForm').reset();
    document.getElementById('sizesContainer').innerHTML = '';
    document.getElementById('specificationsContainer').innerHTML = '';
  }
</script>

</body>
</html>
